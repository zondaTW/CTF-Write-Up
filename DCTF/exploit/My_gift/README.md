#My gift [200]

##Problem
![picture](picture/problem.PNG)  

##Soultion

將程式丟進IDA:  
它剛開始會開啟socket server後，當有人連接近來時，就使用fork()，然後就會執行user_service，因此我們來看一下user_service在做什麼。  
![picture](picture/user_service.PNG)

簡單來說他就是一直接受使用者輸入，然後再將輸入的東西輸出出來，直到使用者輸入sto\*p(\*為任意字元)時，就return回去。  

然後再翻找一下，發現有個讀取gift，並輸出的區塊，猜想主辦方可能將flag放在gift檔案中。  
![picture](picture/cat_gift.PNG)  

接下來開啟qira，並隨意輸入aaaaaaaa，觀察內容。  
![picture](picture/qira_memory.PNG)  

稍微仔細觀察一下可以發現，在0x4000800058的值為0x400a35，這位址是user_service返回時的rip位址，因此我們只要將這個位址蓋成輸出gift的位址，flag就噴出來了。  

![picture](picture/result.PNG)  

Exploit: [pass.py](pass.py)
